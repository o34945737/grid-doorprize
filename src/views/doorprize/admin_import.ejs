<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Admin - Import Excel Peserta</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="container py-4">
  <div class="d-flex justify-content-between align-items-center">
    <h2 class="mb-0">Import Excel Peserta</h2>
    <div class="d-flex gap-2">
      <a href="/doorprize/doorprize/admin" class="btn btn-outline-secondary btn-sm">Dashboard</a>
      <a href="/doorprize/doorprize/admin/grid-draw" class="btn btn-outline-secondary btn-sm">Grid Draw</a>
      <a href="/doorprize/doorprize/admin/logout" class="btn btn-outline-secondary btn-sm">Logout</a>
    </div>
  </div>

  <div class="alert alert-info mt-3">
    Format Excel (sheet pertama): kolom header <b>name</b> dan <b>department</b>.<br/>
    - <b>name wajib</b><br/>
    - department opsional<br/>
  </div>


  <div class="d-flex gap-2 mb-3">
    <a class="btn btn-outline-primary" href="/doorprize/doorprize/admin/import/template">Download Template Excel</a>
  </div>

  <% if (msg) { %>
    <div class="alert <%= ok ? "alert-success" : "alert-danger" %>"><%= msg %></div>
  <% } %>

  <% if (summary) { %>
    <div class="card p-3 mb-3">
      <div class="fw-bold mb-2">Hasil Import</div>
      <ul class="mb-0">
        <li>Total baris dibaca: <b><%= summary.totalRows %></b></li>
        <li>Berhasil insert/update: <b><%= summary.upserted %></b></li>
        <li>Skip (nama kosong): <b><%= summary.skippedEmptyName %></b></li>
      </ul>
    </div>
  <% } %>

  <div class="card p-3">
    <form method="POST" action="/doorprize/admin/import" enctype="multipart/form-data">
      <div class="mb-3">
        <label class="form-label">Upload file .xlsx</label>
        <input type="file" name="file" accept=".xlsx" class="form-control" required>
      </div>
      <button class="btn btn-success">Import</button>
    </form>
  </div>

  <div class="text-muted small mt-3">
    Tips: pastikan sheet pertama berisi data, baris pertama adalah header.
  </div>
</body>
</html>
